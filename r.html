<!DOCTYPE html>
<html lang="en-UK">
<head>
  <Title> Biography of Linus Agbleze </Title>
  <meta charset="UTF-8">
  <Title> Website of Agrimetry business </Title>
  <meta charset="UTF-8">
  <meta name="keywords" content="Linus Agbleze, Linus biography, Strive code preparation, Learn to code">
  <meta name="description" content="Agrimetry support to small scale farmers">
  <meta name="author" content="Linus Agbleze">
  <meta http-equiv="refresh" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="gee.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
</head>
<body style="display: grid">
    <header>
        <nav>
            <div class="topnav" id="myTopnav">
                <a href="home.html" class="active">Home</a>
                <a href="toolset.html">Toolset and skills</a>
                <div class="dropdown">
                  <button class="dropbtn">Conference works 
                    <i class="fa fa-caret-down"></i>
                  </button>
                  <div class="dropdown-content">
                    <a href="conferenceCERES.html">CERES 2019</a>
                    <a href="conf.html">BET 2020</a>
                    <a href="#">GEOBUS 2019</a>
                    <a href="#">First Health and Migration Collaborative Community Symposium</a>
                  </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn">Publications and writing 
                      <i class="fa fa-caret-down"></i>
                    </button>
                    <div class="dropdown-content">
                      <a href="#">Academic publication</a>
                      <a href="#">Non-academic publication</a>
                      <a href="#">Journal review for</a>
                    </div>
                  </div> 
                <a href="#about">Project activities</a>
                <a href="#contact">Contact</a>
                <a href="javascript:void(0);" style="font-size:15px;" class="icon" onclick="myFunction()">&#9776;</a>
              </div>
        </nav>
            
            <script>
            function myFunction() {
              var x = document.getElementById("myTopnav");
              if (x.className === "topnav") {
                x.className += " responsive";
              } else {
                x.className = "topnav";
              }
            }
            </script>
    </header>

    <sidebar class="sidebar">
        <div style="display: inline-flex"><img src="gee-tut.png" style="width: 15%; height: 15%;" class="title-logo"><h2>Google Earth Engine (GEE)</h2></div>
        <div>
            <span><h3><i class="fas fa-book"></i>Introduction to GEE</h3></span>
        </div>

        <div>
            <div><h3><i class="fas fa-book"></i>Normalized Difference Vegetation Index (NDVI) </h3></div>                      
        </div>
        <div class="file-align">
            <div><i class="fas fa-file-alt"></i>Why GEE for Time series analysis</div>
            <div><i class="fas fa-file-alt"></i>Coding practice</div>
            <div><i class="fas fa-file-alt"></i>Interpretation of results</div>
        </div>

        <div>
            <div><h3><i class="fas fa-book"></i>Random Forest classification (Binary)</h3></div>
            <div><i class="fas fa-file-alt"></i>Why GEE for Time series analysis</div>
            <div><i class="fas fa-file-alt"></i>Coding practice</div>
            <div><i class="fas fa-file-alt"></i>Interpretation of results</div>
        </div>

        <div>
            <div><h3><i class="fas fa-book"></i>Time Series analysis of biomes</h3></div>
            <div><i class="fas fa-file-alt"></i>Time series analysis with GEE</div>
            <div><i class="fas fa-file-alt"></i>Why GEE for Time series analysis</div>
            <div><i class="fas fa-file-alt"></i>Coding practice</div>
            <div><i class="fas fa-file-alt"></i>Interpretation of results</div>
        </div>
                
    </sidebar>

    <main>
        <div>
            <h3>Analysis with R</h3>
            <p>In this section, statistical capacity of R and its numerous spatial packages for remote sensing are explored
                through geoscripting. The main objectives were to detect changes within time series and estimate
                correlation between Land Surface Temperature (LST) and NDVI. The workflow for the analysis is thus
                discussed within the context of each objective considered.</p>   
        </div>
        
        <div id="rTimeseries">
            <h3>Change detection in Time series using R</h3>
            <p>
                The dataset used for this analysis was the result of plotting time series graph 
                for different biomes in GEE. This was exported as a csv file hence an input data 
                or analysis in R. The input file contained the NDVI values of the various 
                biomes and their dates of acquisition. As will be expected, both the raw 
                data without cloud masking and preprocessed time series were used. 
                The software used was R studio and scripting was done using R programming 
                language. The workflow for the analysis is discuss below. 
            <br>First, installation of all required packages such as "bfast" and “zoo” was 
                undertaken and their libraries loaded. The working directory was setup and 
                time series data read and inspected. Prior to the actual change detection analysis, 
                the various biomes for the preprocessed time series were plot and this is
                displayed in figure 3.0.

            <div>
                <h4> NDVI time series for 5 biomes</h4>
                <div class="fig-img">
                    <img src="NDVI timeseries.jpg" class="fig-img2">            
                </div>
                <small>Source: Author</small>        
            </div>
    
            <div>
                <p>The figure above indicates the NDVI times series of all biomes over a decade 
                    without decomposing it into various components. To gain a better 
                    understanding of changes occurring within the time series, BFAST
                    is use to decompose them into response, trend and seasons components.
                </p>
                    
                <p>Also, the code is highlighted below</p> 
            </div>
    
            <div class="code-container">
                <code class="codeBlock">
                    #--------------------------------------
# install packages, execute only onces
#--------------------------------------

install.packages("bfast", dependencies=TRUE)

# Load library
library(zoo)
library(bfast)
library(tidyverse)

#--------------------------------------
# Set the working directory 
#--------------------------------------
setwd("C:/Rassign")

## read NDVI time series
Modisndvi_data <- read.csv(file = "C:/Rassign/NDVI series tera.csv") 

## Inspect the time series
head(Modisndvi_data)

## Checking variables
str(Modisndvi_data[1,1:6])

## Create a time Series object for five different biomes 
Modisndvi_ts <- ts(Modisndvi_data[2:6], start=c(2007,1), frequency=23)

#Plot NDVI Time series of the different biomes
plot(Modisndvi_ts,type="l", main = "NDVI Time Series for five Biomes",cex.lab = 0.5, cex.axis=0.75 )


#########################################################################################################
#
### Create time Series object for Cropland (Area of Interest) ###
ModisndviCropland_ts <- ts(Modisndvi_data[,2], start=c(2007,1), frequency=23)

##  Additive decomposition
dc = decompose(ModisndviCropland_ts, type = 'additive')

# Fitting bfast model for Cropland (Testing for breaks in Cropland)
fitCropland = bfast01(Modisndvi_ts, test = "OLS-MOSUM", level = 0.05, aggregate = all, bandwidth = 0.15, functional = "max", order = 3, na.action = na.omit)

# Displaying graph of various components of BFAST of Cropland
plot(fitCropland, plot.type = "multiple",
     which = c("response", "trend", "season"), screens = c(1, 2, 3), main = "BFAST OF CROPLAND")


## fit variations for Cropland
bfCropland <- bfast01(ModisndviCropland_ts)

bfCropland3 <- bfast01(ModisndviCropland_ts, test = c("BIC", "OLS-MOSUM", "supLM"), aggregate = any, bandwidth = 0.15) 

## inspect Cropland test decisions
bfCropland$test
bfCropland$breaks

bfCropland3$test
bfCropland3$breaks

############################################################################################################
#
### Create time Series object for Deciduous Broadleaf Forest (Area of Interest) ###
ModisndviDeciduous_ts <- ts(Modisndvi_data[,3], start=c(2007,1), frequency=23)
##  Additive decomposition
dc = decompose(ModisndviDeciduous_ts, type = 'additive')

## Fitting bfast model for Deciduous Broadleaf Forest (Detecting breaks)
fitDeciduous = bfast01(ModisndviDeciduous_ts, test = "OLS-MOSUM", level = 0.05, aggregate = all, bandwidth = 0.15, functional = "max", order = 3, na.action = na.omit)

# Displaying graph of various components of BFAST of Deciduous Broadleaf Forest
plot(fitDeciduous, plot.type = "multiple",
     which = c("response", "trend", "season"), screens = c(1, 2, 3), main = "BFAST of Deciduous Broadleaf Forest")


## fit variations for Deciduous Broadleaf Forest
bfDeciduous <- bfast01(ModisndviDeciduous_ts)

#Estimate breaks in Deciduous Broadleaf Forest 
bfDeciduous3 <- bfast01(ModisndviDeciduous_ts, test = c("BIC", "OLS-MOSUM", "supLM"), aggregate = any, bandwidth = 0.15) 

## inspect Deciduous Broadleaf Forest test decisions
bfDeciduous$test
bfDeciduous$breaks

bfDeciduous3$test
bfDeciduous3$breaks

#######################################################################################################
#
### Create time Series object for Mixed Forest (Area of Interest) ###
ModisndviMixed_ts <- ts(Modisndvi_data[,4], start=c(2007,1), frequency=23)

##  Additive decomposition
dc = decompose(ModisndviMixed_ts, type = 'additive')

## Fitting bfast model for Mixed Forest (To detect breaks)
fitMixedforest = bfast01(ModisndviMixed_ts, test = "OLS-MOSUM", level = 0.05, aggregate = all, bandwidth = 0.15, functional = "max", order = 3, na.action = na.omit)

# Display graph of various components of BFAST of Mixed Forest
plot(fitMixedforest, plot.type = "multiple",
     which = c("response", "trend", "season"), screens = c(1, 2, 3), main = "BFAST OF Mixed Forest")


## fit variations for Mixed Forest
bfMixedforest <- bfast01(ModisndviMixed_ts)

#Estimate breaks in Mixed Forest
bfMixedforest3 <- bfast01(ModisndviMixed_ts, test = c("BIC", "OLS-MOSUM", "supLM"), aggregate = any, bandwidth = 0.15) 

## inspect Mixed Forest test decisions
bfMixedforest$test
bfMixedforest$breaks

bfMixedforest3$test
bfMixedforest3$breaks

#############################################################################################################
#
### Create time Series object for Evergreen Needleleaved Forest (Area of Interest) ###
ModisndviEvergreen_ts <- ts(Modisndvi_data[,5], start=c(2007,1), frequency=23)

##  Additive decomposition
dc = decompose(ModisndviEvergreen_ts, type = 'additive')

# Fitting bfast model for Evergreen Needleleaved Forest (Testing for breaks)
fitEvergreen = bfast01(ModisndviEvergreen_ts, test = "OLS-MOSUM", level = 0.05, aggregate = all, bandwidth = 0.15, functional = "max", order = 3, na.action = na.omit)

# Display graph of various components of BFAST for Evergreen Needleleaved Forest
plot(fitEvergreen, plot.type = "multiple",
     which = c("response", "trend", "season"), screens = c(1, 2, 3), main = "BFAST OF Evergreen Needleleaved Forest")


## fit variations for Evergreen Needleleaved Forest
bfEvergreen <- bfast01(ModisndviEvergreen_ts)
bfEvergreen3 <- bfast01(ModisndviEvergreen_ts, test = c("BIC", "OLS-MOSUM", "supLM"), aggregate = any, bandwidth = 0.15) 

## inspect Evergreen Needleleaved Forest test decisions
bfEvergreen$test
bfEvergreen$breaks

bfEvergreen3$test
bfEvergreen3$breaks

#########################################################################################################
#
### Create time Series object for Urban Builtup (Area of Interest) ###
ModisndviUrban_ts <- ts(Modisndvi_data[,6], start=c(2007,1), frequency=23)

##  Additive decomposition
dc = decompose(ModisndviUrban_ts, type = 'additive')

# Fitting bfast model for Urban Builtup (Testing for breaks)
fitUrban = bfast01(ModisndviUrban_ts, test = "OLS-MOSUM", level = 0.05, aggregate = all, bandwidth = 0.15, functional = "max", order = 3, na.action = na.omit)

# Display various components of BFAST for Urban Builtup
plot(fitUrban, plot.type = "multiple",
     which = c("response", "trend", "season"), screens = c(1, 2, 3), main = "BFAST OF Urban Builtup")


## fit variations for Urban Builtup
bfUrban <- bfast01(ModisndviUrban_ts)
bfUrban3 <- bfast01(ModisndviUrban_ts, test = c("BIC", "OLS-MOSUM", "supLM"), aggregate = any, bandwidth = 0.15) 

## inspect Urban Builtup test decisions
bfUrban$test
bfUrban$breaks

bfUrban3$test
bfUrban3$breaks


                </code>
            </div>
    
        </div>

        
        <!--BFAST process-->
        <div id ="bfast-process">
            <h3>Using BFAST for detecting and estimating changes in time series of biomes</h3>
            <div>
                <p> Time series object was created for five different biomes and plotted. Analyzing time series involved
                    decomposing into different components to detect change. In that regard, Breaks For Additive Seasonal
                    and Trend (BFAST) was employed in decomposing time series into trend, seasonal, and remainder
                    components for the 16-day MODIS NDVI time series. This algorithm was employed to enable the
                    calculation of the time and number of changes as well as magnitude and direction of change as suggested
                    by Verbesselt et al (2010). The main advantage of this method of change detection compared to others is
                    reduction in subjectivity and analyst’s discretion as it avoids selection of a reference period, setting of a
                    threshold and defining a change trajectory (Verbesselt, 2010). This is spurred by detection of multiple
                    abrupt and gradual changes within a time series (Lambert, 2013). Whiles there is the possibility of
                    detecting changes in all the decomposed components, different factors are responsible for changes in
                    different components. Changes detected in the trend component is attributed to disturbances whiles
                    phenological changes in land cover characterizes the seasonal component (Verbesselt, 2010). Further, BFAST model was fitted on the data with different variations. Prior to estimating the breakpoints, an initial BFAST model with only ordinary least squares (OLS) residuals-based MOving SUM (MOSUM)
                    test was fitted to detect whether or not breakpoints were occurring in the time series of the biome as
                    suggested by Bai and Perron (2003) and Zeileis (2005). The function also omitted values not available
                    and is presented below
                </p>
                
            </div>

            <div>
                <h4>Initial BFAST model with only ordinary least squares (OLS) residuals-based MOving SUM (MOSUM)</h4>
                <div class="fig-img">
                    <img src="fits.jpg" class="fig-img2">
                </div>
                <small>Source: Author</small>
            </div>

            <div>
                <p>
                    Whiles Bai and Perron (2003) have suggest that further test to estimate 
                    breaks should be conducted only after the first test with OLS-MOSUM 
                    indicates significant change; other variations of the BFAST model
                    using Bayesian Information Criterion (BIC) were fitted irrespective of the 
                    result of the test for break. This was done in the report for demonstration 
                    purposes. The function with BIC as highlighted below estimates the number 
                    of breaks including the date and confidence interval (Bai and Perron, 2003).
                </p>
            </div>

            <div>
                <h4>Initial BFAST model with only ordinary least squares (OLS) residuals-based MOving SUM (MOSUM)</h4>
                <div class="fig-img">
                    <img src="bf3.jpg" class="fig-img2">
                </div>
                <small>Source: Author</small>
            </div>

            <div>
                <p>
                    The BFAST model was applied to the NDVI time series of various biomes which are define to be region
of interest for this exercise. The results of running the R codes on the preprocessed time series are
presented below with interpretations.
                </p>
            </div>
    
            <div>
                <h4>BFAST for preprocessed NDVI time series of cropland</h4>
                <p>
                    The results for applying BFAST function on time series of cropland depicts the trend component to be
monotonic (non-increasing). The season component harbours variations at a constant rate which is
evident throughout the time series. This can be explain by the nature of the biome being cropland where it
is used for farming purposes which undergoes a predictable change of land clearing, planting and
harvesting. Such changes are rather seasonal and when repeated over the time period will represent
persistent changes of the same magnitude as illustrated in the figure below.Hypothetically, changes
witnessed in the seasonal component is the result of changes in growth stage of vegetative cover
supported by weather conditions (temperature and rainfall) or short term changes in human activity and
land use.
                </p>
            </div> 
            
            <div>
                <h4>Results of BFAST for preprocessed NDVI time series of Cropland</h4>
                <div class="fig-img">
                    <img src="bfast cp.jpg" class="fig-img2">
                </div>
                <small>Source: Author</small>
            </div>

            <div>
                <p>
                    Testing the BFAST model for breaks proved false as result for both BIC and SupLM and true for
OLS-MOSUM which is indicated in the figure below. The abrupt change observed in the time series is
most likely present in the trend component but not visible in the decomposed graph because of missing
values.
                </p>
            </div>

            <div>
                <h4>Results of BFAST for preprocessed NDVI time series of Cropland</h4>
                <div class="fig-img">
                    <img src="bf crp res.jpg" class="fig-img2">
                </div>
                <small>Source: Author</small>
            </div>


            <div>
                <h4> BFAST for preprocessed NDVI time series of Deciduous broad-leave forest</h4>
                <p>
                    The time series of deciduous forest indicates no break or abrupt change in the trend component. The trend
component was monotonic (non-decreasing) and variations in the seasonal component were at constant
rate.
                </p>
            </div> 
            <div>
                <h4>BFAST result of preprocessed NDVI time series of Deciduous broad-leave forest</h4>
                <div class="fig-img">
                    <img src="bf prepro ndvi deciduous.jpg" class="fig-img2">
                </div>
                <small>Source: Author</small>

                <div>
                    <p>Inspecting and testing the BFAST for breaks in deciduous broadleaf forest produced “True” as result for
                        only supLM. The result is illustrated in the figure below.
                    </p>

                    <h4>Inspecting BFAST of Deciduous broad-leaf forest (preprocessed)</h4>
                <div class="fig-img">
                    <img src="deci bf.jpg" class="fig-img2">
                </div>
                <small>Source: Author</small>
                </div>
            </div>


            <div>
                <h4> BFAST for preprocessed NDVI time series of Mixed forest</h4>
                <p>
                    The result of applying BFAST model on Mixed forest indicates no major break in the time series and the
trend component assumes a monotonic and non-decreasing structure. The slope of the trend is relatively
gentle and gradual change is identifiable. This suggests that Mixed forest biome has not experience major
disturbance to warrant an abrupt change but seasonal variations.
                </p>
            </div> 
            <div>
                <h4>Result: BFAST for Mixed forest (preprocessed)</h4>
                <div class="fig-img">
                    <img src="mixed bf.jpg" class="fig-img2">
                </div>
                <small>Source: Author</small>

                <div>
                    <p>Inspection of the variations of BFAST model applied on Mixed forest indicates that no abrupt break was
                        tested for OLS-MOSUM and BIC but supLM tested true for detected breaks. This is captured in the
                        figure below.
                    </p>

                    <h4>Result of testing variations of BFAST model on Mixed Forest (preprocessed)</h4>
                <div class="fig-img">
                    <img src="res bfast.jpg" class="fig-img2">
                </div>
                <small>Source: Author</small>
                </div>

                <div>
                    <h4> BFAST for Evergreen Needle-leaved forest (preprocessed)</h4>
                    <p>
                        The results of applying BFAST for Evergreen needle-leaved forest indicates the trend component to be
monotonic and non-decreasing. Moreover, no abrupt change was detected in the time series of this biome. Constant variations are evident in the season component of the time series which is attributable to
short-lived weather changes.
                    </p>
                </div> 
                <div>
                    <h4>Decomposition of time series of Evergreen Needle-leaved forest (preprocessed)</h4>
                    <div class="fig-img">
                        <img src="bf ever.jpg" class="fig-img2">
                    </div>
                    <small>Source: Author</small>
    
                    <div>
                        <p>Testing the variations of BFAST model applied indicates there was no break in the time series of
                            Evergreen needle-leaved forest. This is illustrated in the image below.
                        </p>
    
                        <h4>Result of inspecting and testing BFAST on Evergreen Forest (preprocessed)</h4>
                    <div class="fig-img">
                        <img src="res ever bf.jpg" class="fig-img2">
                    </div>
                    <small>Source: Author</small>
                    </div>


                    <div>
                        <h4> BFAST of time series for Urban Builtup (preprocessed)</h4>
                        <p>
                            BFAST result of urban built-up biome indicates a monotonic and non-decreasing trend component. There
was no abrupt break detected in the time series. This is likely the case because a natural environment that
have been changed by human activities and land use (urbanization) thus with low NDVI may require a
long time period to recover and gain a high NDVI value to indicate an abrupt change. The time series
considered may thus be relatively short to capture an abrupt change in urban builtup biome. Changes in
the seasonal component are of the same magnitude throughout the time series.
                        </p>
                    </div> 
                    <div>
                        <h4>BFAST of Urban builtup (preprocessed)</h4>
                        <div class="fig-img">
                            <img src="bf urban.jpg" class="fig-img2">
                        </div>
                        <small>Source: Author</small>
        
                        <div>
                            <p>Testing the variations of BFAST model applied indicates there was no break in the time series of
                                Evergreen needle-leaved forest. This is illustrated in the image below.
                            </p>
        
                            <h4>Inspection of the variation of BFAST model applied indicated there was no break</h4>
                        <div class="fig-img">
                            <img src="insp urban.jpg" class="fig-img2">
                        </div>
                        <small>Source: Author</small>
                        </div>


        </div>

        
        <!--BFAST analysis of NDVI time series (without cloud masking)-->

        <div id="bfwithoutcloud">
            <h3>BFAST analysis of NDVI time series (without cloud masking)</h3>
            <p>This section of the paper presents the results of BFAST analysis of NDVI time series without cloud
                masking for the various biomes. The same method used to achieve the results of the preprocessed data
                was applied. The result of the raw data that is without cloud masking is interpreted and compared to that
                of the preprocessed data</p>

                <div>
                    <h4>1 BFAST for NDVI time series of cropland (without cloud masking)</h4>
                    <p>
                        The results for applying BFAST function on time series of cropland depicts the trend component to be
monotonic (non-decreasing) in comparison to non-increasing for preprocessed data. This implies a change
in the direction of trend. Changes occurring in the season component were consistent and is illustrated in
the figure below.
                    </p>
                    <div><h4>Results of BFAST for NDVI time series of Cropland (without preprocessing)</h4></div>
                    <div class="fig-img">
                        <img src="crp nocloud.jpg" class="fig-img2">
                    </div>
                    <small>Source: Author</small>
    
                    <div>
                        <p>Testing the BFAST model revealed that no breaks were identified for OLS-MOSUM and BIC but one
                            break detected for SupLM. This is illustrated below
                        </p>
    
                        <h4> Inspecting and testing BFAST function of cropland (without cloud masking)</h4>
                    <div class="fig-img">
                        <img src="insp crp nocloud.jpg" class="fig-img2">
                    </div>
                    <small>Source: Author</small>
                    </div>

                    <div>
                        <h4> BFAST for Deciduous broadleaved forest (without cloud masking)</h4>
                        <p>
                            The time series of deciduous forest indicates a break which is represented in the trend component. Different trends are evident within the time series. The abrupt change detected in the trend component
occurred in 2011 approximately. On the whole, the trend component is seen to be non-monotonic. The
trend component as depicted captures much more information including time of break and its
corresponding confidence interval (marked in red). Also, the abrupt change is most likely to result from a
severe disturbance of the deciduous broadleaf forest. This result differs entirely from the preprocessed
data result where trend as monotonic and non-decreasing with no breaks.
                        </p>
                        <div><h4>Result of BFAST Deciduous Broadleaf Forest (without cloud masking)</h4></div>
                        <div class="fig-img">
                            <img src="deci nocloud.jpg" class="fig-img2">
                        </div>
                        <small>Source: Author</small>
        
                        <div>
                            <p>Inspecting and testing the BFAST for deciduous broadleaved forest proved that there was a break in the
                                time series captured by OLS-MOSUM. This is also illustrated in the BFAST graph.
                            </p>
        
                            <h4> 3 Estimating breaks in the Deciduous Broadleaf Forest (without cloud masking)</h4>
                        <div class="fig-img">
                            <img src="insp deci nocloud.jpg" class="fig-img2">
                        </div>
                        <small>Source: Author</small>
                    </div>

                    <div>
                        <h4>BFAST for Mixed forest (without cloud masking)</h4>
                        <p>
                            Comparing the results of the raw data with that of preprocessed data,
                             there was no difference recognized. The trend component remained monotonic (non decreasing).
                        </p>
                        <div><h4>4 Time series result of Mixed forest (without cloud masking)</h4></div>
                        <div class="fig-img">
                            <img src="mixed nocloud.jpg" class="fig-img2">
                        </div>
                        <small>Source: Author</small>
        
                        <div>
                            <p>Inspection of the BFAST model applied on Mixed forest indicates that there was no abrupt break in
                                OLS-MOSUM and BIC but testing supLM proved true for detected breaks. This is captured in the figure
                                below.
                            </p>
        
                            <h4>Inspecting breaks in time series of Mixed forest (without cloud masking)</h4>
                        <div class="fig-img">
                            <img src="insp mixed nocloud.jpg" class="fig-img2">
                        </div>
                        <small>Source: Author</small>
                    </div>


                    <div>
                        <h4>BFAST for time series of Evergreen forest (without cloud masking)</h4>
                        <p>
                            The results of applying BFAST on evergreen forest time series without cloud 
                            masking indicates a the
trend component to be monotonic and non-increasing which differs from a non-decreasing trend for the
raw data. Thus, a change in the direction of trend is noted. However, both dataset detected no breaks in
the time series.
                        </p>
                        <div><h4>Time series of Evergreen forest (without cloud masking)</h4></div>
                        <div class="fig-img">
                            <img src="ever nocloud.jpg" class="fig-img2">
                        </div>
                        <small>Source: Author</small>
        
                        <div>
                            <p>Inspecting the BFAST time series of Evergreen forest, there was no break in the 
                                time series for this biome. This is capture in the figure below.
                            </p>
        
                            <h4>Estimating breaks in time series of Evergreen forest (without cloud masking)</h4>
                        <div class="fig-img">
                            <img src="insp ever nocloud.jpg" class="fig-img2">
                        </div>
                        <small>Source: Author</small>
                    </div>


                    <div>
                        <h4>BFAST of Time series of Urban Builtup (without cloud masking)</h4>
                        <p>
                            BFAST result of urban builtup biome illustrates a nonlinear trend with a single abrupt break occurring in
2011. Proceeding from the abrupt break, a gradual change is depicted. Within the urban builtup, abrupt
change is most likely to result from human activities and land use change as oppose to natural climatic
conditions. Such a change will require lot of time for the natural environment to recover and this is
depicted in the gradual response of change after the break. The magnitude of Seasonal changes are
constant but vary in two time-steps with relatively higher changes occurring prior to the break compared
to the aftermath of the break. The break and confidence interval are depicted in red. This result
significantly differs from that of preprocessed data where there was no break and trend as monotonic
(non-decreasing).
                        </p>
                        <div><h4>8 BFAST of Urban builtup</h4></div>
                        <div class="fig-img">
                            <img src="unrban nocloud.jpg" class="fig-img2">
                        </div>
                        <small>Source: Author</small>
        
                        <div>
        
                            <h4>Inspection of the various BFAST model detected a break</h4>
                        <div class="fig-img">
                            <img src="insp urba nocloud.jpg" class="fig-img2">
                        </div>
                        <small>Source: Author</small>
                    </div>
               
        
                
        </div>

        <div id="correlate">
            <div>
                <h3> Estimating the correlation between MODIS Land Surface Temperature and NDVI data</h3>
                <p>
                    This exercise used MODIS data particularly MOD13A2 with NDVI band and MOD11A2 with Land
Surface Temperature band acquired with Terra satellites. Selection of these dataset was based on the
desire to obtain a common spatial resolution of 1km. Scripts were written in GEE to filter the dataset and
select only the NDVI and LST bands for export and used as input dataset in R. This process involving the
extraction of LST and NDVI also included scaling of the dataset prior to download. The NDVI
MOD13A2 was scaled with the factor 0.0001 whiles LST MOD11A2 was scaled with the factor 0.02. The codes for the extraction of LST and NDVI from GEE are provided below.
                </p>
                <div>
                    <p>The code for extracting NDVI MOD13A2 data from GEE can be access from this <a href="https://code.earthengine.google.com/5bba784baa5e11172bc6b5f3ace0b1f4" target="_blank">link</a></p>

                    <p>The code for extracting LST MOD11A2 data from GEE can be access from this <a href="https://code.earthengine.google.com/e66d4d3b1e2d519945c7cdf4b7566f87" target="_blank">link</a></p>

                </div>
                <div>
                    <p>Another dataset used as input in R was shapefile of Western Region of Ghana (WRG). The complete
                        regional boundary was downloaded from RSGIS lab and western region extracted using the extract tool in
                        ArcGIS. Selection of Western Region as ROI was based on availability of data and preliminary
                        knowledge of land cover and climate of the area. The shapefile of Western Region was used as the region
                        of interest to crop the NDVI and LST data in R</p>
                </div>

                <div>
                    <h4>Workflow of correlation analysis of NDVI and LST in R</h4>
                    <p>
                        In R studio, the raster package was installed and library loaded whiles the working directory was setup. The
NDVI and LST raster data as well as shapefile of Western region of Ghana were loaded. The shapefile
was used to crop both NDVI and LST and correlation function applied on the subset raster images. Further, Pearson value correlation and P value were plotted. The results are displayed and interpreted
below.
                    </p>
                </div>

                <div>        
                    <div class="code-container">
                        <code class="codeBlock">
                #--------------------------------------
                # install packages, execute only ones
                #--------------------------------------
                install.packages("raster")
                
                #Load Library  
                library(raster)
                library(sp) 	   # provides classes for spatial data in R
                library(raster)	 # provides classes and methods for raster datasets
                library(rgdal)	 # interface to the Geospatial Data Abstraction Library to read and write different spatial file formats
                
                
                
                # Defining the working directory
                setwd('C:/Rassign/CORRELATION') #/EXTRACT/NDVI')
                
                #Load Raster images
                NDVI <- raster("NDVIMOD13A2.tif")
                LST <- raster("MODISLST11A2.tif")
                
                #Load shapefile of ROI
                ROI <- readOGR(dsn = 'C:/Rassign/CORRELATION', layer = 'Western region')
                plot(ROI)
                
                #cropping the NDVI image with ROI,
                NDVISub <- crop(NDVI, extent(ROI))
                plot(NDVISub)
                
                #Cropping the LST image with ROI
                LSTSub <- crop(LST, extent(ROI))
                plot(LSTSub)
                
                Pal <- colorRampPalette(c("red" , "blue" , "green"))
                
                #Correlation function
                corrNDVI_LST <- corLocal(NDVISub , LSTSub , test = T)
                plot(corrNDVI_LST)
                
                # Plot Pearson value correlation and P value
                plot(corr$pearson , col = Pal(20) , main = "Pearson Correlation")
                plot(corr$p.value , col = c("red" , "blue" , rep("azure3" , 15)) ,main = "p-value")
                        </code>
                    </div>
                </div>
                    
                
                


                <div><h4>Comparison of MODIS NDVI and LST in Western Region of Ghana</h4></div>
                <div class="fig-img">
                    <img src="Modis and lst.jpg" class="fig-img2">
                </div>
                <small>Source: Author</small>

                <div>
                    <p>The figure above illustrates a comparison of the spatial distribution of NDVI and Land Surface
                        Temperature in Western region of Ghana. The region is dominated by the distribution of high NDVI
                        values (0.6 to 0.8) which can be interpreted to be forest. This is supported by evidence of the large
                        tropical rain forest, semi-deciduous forest, mangrove cover in the midst other land use (Hall and Swaine, 2013). This depicts the variation of NDVI values in the area . Also, relatively high LST in the range of
                        300 to 310 is dominant within the region. To gain a better understanding of the relationship between
                        NDVI and LST in the region, a correlation analysis was undertake of which the result is displayed below.
                    </p>

                    <h4>Correlation of NDVI and LST</h4>
                <div class="fig-img">
                    <img src="pearson.jpg" class="fig-img2">
                </div>
                <small>Source: Author</small>
            </div>

            <div>
                <p>
                    The figure above illustrate how NDVI and LST of areas within western region of Ghana correlate. The
areas with green colour have positive correlation within the range of 0.5 to 1.0 which implies that as
NDVI increases in these areas, LST also increases and this is of a moderate to high association. The
pearson value was plotted to provide clarity.
                </p>
            </div>
            <h4>Plot of Pearson correlation and P value</h4>
                <div class="fig-img">
                    <img src="plot perason.jpg" class="fig-img2">
                </div>
                <small>Source: Author</small>
            </div>


        </div>

        

    </main>

    <footer>
        <div class="foot align-all">
            <div class="foot-items">
                <div id="contact"><h4>Contact</h4>
                    <address id="opr"; Style="text-align:left;">
    
                        Am Jesuitenhof<br>
                        Bonn<br>
                        Nordrhine Westphalia<br>  
                        Germany<br>
                        Lagbleze@st.ug.edu.gh<br>
                        +4915175701653<br>
                        </address>
                        <!-- 
                        <script>
                        function myFunc5(){
                          document.getElementById("opr").style.fontSize= "20px";
                          document.getElementById("opr").style.color = "red";
                          document.getElementById("opr").style.backgroundColor = "yellow";
                        }
                        </script>
                        <button type="button" onclick="myFunc5()">Magnify</button>
                        -->
                </div>
            </div>
    
            
            <div class="foot-items">
                <div id="projects">
                    <h4>Project collaboration</h4>
                    <p><a href="">Seed 4 Seed project with ACESWorld</a></p>
                    <p><a href="">Pad4Learing project with ACESWorld</a></p>
                    <a href=""></a>
                </div>
            </div>
    
            <div class="foot-items">
                <div id="publish">
                   <h4> Pulications </h4>
                    <p><a href="">Gendered perspective: Climate change adaptation in Malawi</a></p>
                    <p><a href="">Digitalization and innovation as a driver of sole proprietorship in Ghana</a></p>
                    <p><a href="">
                        Climate change mitigation-adaptation matrix: a better tool and benchmark for climate action with policy implication at local and national level.
                        </a>
                    </p>
                    <h5>Blog posts</h5>
                    <p><a href="">Gendered perspective: Climate change adaptation in Malawi</a></p>
                    <p><a href="">COVID-19 SET TO THWART CLIMATE CHANGE ADAPTATION WHILE AIDING MITIGATION</a></p>
                </div>
            </div>
    

        </div>
        
    </footer>
    

</body>


</html>

